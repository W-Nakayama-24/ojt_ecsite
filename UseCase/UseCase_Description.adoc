:lang: ja
:doctype: book
:toc: left
:toclevels: 3
:toc-title: 目次
:sectnums:
:sectnumlevels: 4
:sectlinks:
:imagesdir: ./_images
//画像イメージのディレクトリを指定 (NOTEやTIPのマークを持ってくる)
:icons: font
:source-highlighter: coderay 
//coderay: コード部分をハイライトさせる gem install coderay
:example-caption: 例
:table-caption: 表
:figure-caption: 図
:docname: = asciidoc-ECサイト機能仕様書
:author: Nakayama
:revnumber: 1.0
:revdate: 2020/01/09

= ECサイト 機能仕様書

== 概要
'''

このECサイトは、販売中の商品をブラウザ上に一覧表示する。 + 
利用者は表示されている商品を選んで購入でき、 + 
一覧表示する商品は検索機能で条件を指定して絞り込むことができる。


== ECサイトのユースケース
'''
ECサイトが実現する機能を3つのユースケースに分類しユースケースIDを振り分けた。 + 
分類とユースケースIDは、以下の図に表した通りである。

image::https://raw.githubusercontent.com/W-Nakayama-24/ojt_ecsite/develop/UseCase/EC%E3%82%B5%E3%82%A4%E3%83%88_%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9%E5%9B%B3.png[usecase]

== 画面遷移図
'''
利用者がブラウザ上で見る画面の遷移を以下の図に表した。

image::https://raw.githubusercontent.com/W-Nakayama-24/ojt_ecsite/747e38f2eab19219aca3e3e861c99f0b49b8b6ab/UseCase/EC%E3%82%B5%E3%82%A4%E3%83%88%20%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3.png[screentransition]

== 機能一覧

[cols="1*,3a", options="header"]
|===
|ユースケースID
|機能名称(ユースケース名称)

|UC01
|商品を一覧表示する

|UC02
|商品を購入する

|UC03
|商品を検索して表示する

|===

== 機能詳細
'''

=== 商品を一覧表示する

[cols="1h,3a"]
|===
|ユースケースID
|UC01

|ユースケース名称
|商品を一覧表示する

|概要
|<<image_viewall,商品一覧画面>>の表示

|優先度
|MUST

|アクター
|利用者

|トリガー
|* ECサイトのURLを指定・アクセス
* <<image_buy,購入明細画面>>で「全商品一覧へ戻る」ボタンを押下する

|事前条件
|Webブラウザを起動している

|基本フロー
|
. 利用者はECサイトのURLを指定してアクセスする
. <<image_viewall,商品一覧画面>>が表示される。

|代替フロー
|なし

|例外フロー
|なし


|事後条件
|<<image_viewall,商品一覧画面>>が表示されている

|===

[[image_viewall]]

==== 画面仕様：商品一覧画面

商品一覧画面のイメージと、実現する機能は以下の通りである。

image::https://raw.githubusercontent.com/W-Nakayama-24/ojt_ecsite/develop/UseCase/screenImages/image_viewall.PNG[image_viewall]

[cols="3*,3a", options="header"]
|===
|No.
|項目名
|種別
|説明

|1
|商品情報表示領域
|表示領域
|商品の名前、税込価格、税抜価格、画像を表示する

※ 商品情報表示の形式は「価格が安い順、横方向に4商品分ずつ並べて表示」とする。
※ 商品情報は、最大で1ページあたり12商品分表示する

|2
|選択ボックス
|チェックボックス
|クリックすると対応する商品が「選択済み」状態になる
※再度クリックすると選択は解除される

|3
|購入ボタン
|ボタン
|クリックすると「<<_商品を購入する,商品を購入する>>」機能を実行する

|4
|検索フォーム(商品名)
|入力欄
|文字列,数字を入力して検索条件(商品名)を指定する

|5
|検索フォーム(価格) 下限値欄
|入力欄
|整数を入力して検索条件(価格の下限値)を指定する

|6
|検索フォーム(価格) 上限値欄
|入力欄
|整数を入力して検索条件(価格の上限値)を指定する

|7
|検索ボタン
|ボタン
|クリックすると「<<_商品を検索して表示する,商品を検索して表示する>>」機能を実行する

※検索条件の指定が無いとき(すべての検索フォームに入力が無いとき)、ボタンはクリックできない

|8
|メッセージ領域
|表示領域
|ECサイトから利用者へのメッセージを表示する


|===

''''

=== 商品を購入する

[cols="1h,3a"]
|===
|ユースケースID
|UC02

|ユースケース名称
|商品を購入する

|概要
|利用者が商品を選択した状態で<<image_viewall,商品一覧画面>>の購入ボタンを押下すると、購入処理を行い<<image_buy,購入明細画面>>に遷移する。

|優先度
|MUST

|アクター
|利用者

|トリガー
|購入ボタンを押下する

|事前条件
|* <<image_viewall,商品一覧画面>>がブラウザに表示されている
* 購入したい商品のチェックボックスを押下し、「選択済み」状態にしている

|基本フロー
|
. 利用者はブラウザ上で購入ボタンを押下する
** [red]##「選択済み」状態の商品が無い場合## ⇒ <<exflow_uc02,例外フロー1に移行>>
** [red]##(want)選択した商品の在庫が無い場合## ⇒ <<exflow_uc02,例外フロー2に移行>>
. <<image_buy,購入明細画面>>に遷移し、購入日時、購入商品一覧、合計金額を表示する

|代替フロー
|なし

|例外フロー
|

[[exflow_uc02]]

. 購入する商品を選択していない場合
.. 購入の処理は実施せず、エラーメッセージ01をメッセージ領域に表示する
.. <<image_viewall,商品一覧画面>>から遷移せずにシナリオを終了する

. (want)選択した商品の在庫が無い場合
.. 購入の処理は実施せず、エラーメッセージ02をメッセージ領域に表示する
.. <<image_viewall,商品一覧画面>>から遷移せずにシナリオを終了する

|事後条件
|<<image_buy,購入明細画面>>が表示されている

|補足
|

エラーメッセージ01
....
購入に失敗しました
(商品が選択されていません)
....

エラーメッセージ02
....
購入に失敗しました
(選択した商品の在庫がありません)
....

|===
''''

[[image_buy]]
==== 画面仕様：購入明細画面

購入明細画面のイメージと、実現する機能は以下の通りである。

image::https://raw.githubusercontent.com/W-Nakayama-24/ojt_ecsite/bd56354d2367766916d5ba3fb4b14f81b4452ce2/UseCase/screenImages/image_buy.PNG[buy]

[cols="3*,3a", options="header"]
|===
|No.
|項目名
|種別
|説明

|1
|購入明細表示領域
|表示領域
|購入日時、購入商品一覧、合計金額(税込金額と税抜金額の両方)を表示する


|2
|全商品一覧に戻るボタン
|ボタン
|クリックすると<<image_viewall,商品一覧画面>>に遷移する

|===

''''

=== 商品を検索して表示する

[cols="1h,3a"]
|===
|ユースケースID
|UC03

|ユースケース名称
|商品を検索して表示する

|概要

|* 利用者が商品一覧画面の検索フォームに入力した文字列を含む商品のみを表示する。
* 利用者が商品一覧画面の検索フォームに入力した価格の範囲内にある商品のみを表示する。

|優先度
|MUST

|アクター
|利用者

|トリガー
|検索ボタンを押下する

|事前条件
|* <<image_viewall,商品一覧画面>>がブラウザに表示されている

|基本フロー
|
. 利用者は検索フォームに文字列または数字を入力する
. 利用者はブラウザ上で検索ボタンを押下する
** [red]##検索フォーム(価格)に整数以外が入力されている場合##　⇒ <<altflow_uc03,代替フロー1に移行>>
** [red]##検索フォーム(価格)の下限値欄と上限値欄両方に入力があり、上限値の入力価格が下限値欄の入力価格より小さい場合
##　⇒ <<altflow_uc03,代替フロー2に移行>>

. 検索フォームの入力内容に対応する商品のみを<<image_viewall,商品一覧画面>>の「①商品情報表示領域」に新しく表示する
+
(参考画像：検索実行後の画面イメージ)
+
image::https://raw.githubusercontent.com/W-Nakayama-24/ojt_ecsite/bd56354d2367766916d5ba3fb4b14f81b4452ce2/UseCase/screenImages/image_search.PNG[search]



|代替フロー
|
[[altflow_uc03]]

. 検索フォーム(価格)に整数以外が入力されている場合
.. エラーメッセージ03をメッセージ領域に表示する


. 検索フォーム(価格)の下限値欄と上限値欄両方に入力があり、上限値の入力価格が下限値欄の入力価格より小さい場合
.. エラーメッセージ04をメッセージ領域に表示する


|例外フロー
|なし

|事後条件
|<<image_viewall,商品一覧画面>>が表示されている

|補足
|

エラーメッセージ03
....
検索フォーム(価格)の入力が正しくありません
(整数で価格を指定してください)
....

エラーメッセージ04
....
価格の範囲指定が正しくありません
(価格フォームの左側に下限値、右側に上限値を入力してください)
....

商品名の検索フォームと価格の検索フォーム両方に正しい入力があった場合は、
商品名での絞り込みと価格での絞り込みを同時に行う(AND検索を実行する)。

商品名検索、価格検索、両方を用いたAND検索はそれぞれ部分一致検索を実行する。

アルファベットを含む文字列で商品名検索をするとき、大文字と小文字は区別しない。

※ 検索フォームのバリデーション条件を以下に定義する。

* 検索フォーム(商品名)
** シングルクォーテーション(')、ダブルクォーテーション(")を除く文字列の入力を受け付ける
** 価格の検索フォームに入力がある場合のみ、空欄を認める
** 入力可能文字数制限：250文字まで

* 検索フォーム(価格)　
** 入力は整数であること
** 下限値欄のみの入力、上限値欄のみの入力を認める
** 商品名の検索フォームに入力がある場合のみ、両方とも空欄を認める
** 下限値欄と上限値欄の両方に入力があるとき、上限値欄の入力価格が下限値欄の入力価格以上であること
** 入力可能文字数制限：下限値欄、上限値欄ともに9文字まで

|===
''''